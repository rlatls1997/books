## 56. 공개된 API 요소에는 항상 문서화 주석을 작성하라

API를 쓸모있게 사용하려면 잘 작성된 문서도 필요하다.

자바에서는 자바독(Javadoc)이라는 유틸리티가 이 작업을 도와준다.

자바독은 문서화주석(doc commen; 자바독 주석)이라는 형태로 기술된 설명을 추려서 API문서로 변환해준다.

자바 5에는 @literal, @Code

자바 8에는 @implSpec

자바 9에는 @index

등 버전이 올라가면서 중요한 자바독 태그가 추가되었다.

**API를 올바로 문서화하려면 공개된 모든 클래스, 인터페이스, 메서드, 필드 선언에 문서화 주석을 달아야 한다**

문서가 잘 갖춰지지 않은 API는 쓰기 헷갈려서 오류의 원인이 되기 쉽다.

기본생성자에는 문서화 주석을 달 방법이 없으므로 공개 클래스에는 절대 기본생성자를 사용하면 안된다.

유지보수를 고려한다면 공개되지 않은 클래스, 인터페이스, 생성자, 메스드, 필드에도 문서화 주석을 달아야할 것이다.

**메서드용 문서화 주석에는 해당 메서드와 클라이언트 사이의 규약을 명료하게 기술해야 한다**

- 상속용으로 설계된 클래스의 메서드가 아니라면 메서드가 어떻게 동작하는지가 아니라 무엇을 하는지를 기술해야 한다. (how가 아닌 what)
- 해당 메서드를호출하기 위한 전제조건을 모두 나열해야한다.
- 메서드가 성공적으로 수행된 후 만족해야하는 사후조건도 모두 나열해야한다.
- 일반적으로 전제조건은 @throws태그로 비검사 예외를 선언하여 암시적으로 기술한다
- @param 태그를 이용해 그 조건에 영향받는 매개변수를 기술할 수 있따.

- 전제조건, 사후조건뿐 아니라 부작용도 문서화해야한다.
  ex) 백그라운드 스레드를 시작시키는 메서드라면 그 사실을문서에 밝혀야한다.

- 메서드의 계약을 완벽히 기술하려면 모든 매개변수에 @param태그, 반환타입이 void가 아니라면 @return태그, 발생가능성이있는 모든 예외에 @throws 태그를 달아야 한다.

- 관례상 @param, @return 태그의 설명은 매개변수가 뜻하는 값이나 반환값을 설명하는 명사구를 쓴다.

```java
/**
* 이 리스트에서 지정된 위치의 원소를 반환한다
*
* <p>이 메서드는 상수시간에 수행됨을 보장하지 <i>않는다</i>. 구현에 따라
* 원소의 위치에 비례해 시간이 걸릴수도 있다.
*
* @param index 반환할 원소의 인덱스; 9 이상이고 리스트 크기보다 작아야 한다
* @return 이 리스트에서 지정한 위치의 원소
* @throws IndexOutOfBoundsException index가 범위를 벗어나면,
*           즉, ({@code index < 0 || index >= this.size()}) 이면 발생한다.
*
```

- 자바독 유틸리티는 문서화 주석을 HTML로 변환하므로 문서화 주석 안의 HTML요소들이 최종 HTML문서에 반영된다.



- {@code} 태그
    - 태그로 감싼 내용을 코드용 폰트로 렌더링한다.
    - 태그로 감싼 내용에 포함된 HTML요소나 다른 자바독 태그를 무시한다.
    - 여러줄로 된 코드 예시를 넣으려면 {@code} 태그를 <pre>태그로 감싸면 된다.

- 인스턴스 메서드의 문서화 주석에 쓰인 ‘this’는 관례상 호출된 메서드가 자리하는 객체를 가리킨다.

**@implSpec**

클래스를 상속용으로 설계할 때는 자기사용 패턴에 대해서도 문서에 남겨 다른 프로그래머에게 그 메서드를 올바로 재정의하는 방법을 알려줘야한다.

자기사용 패턴은 자바8의 @implSpec태그로 문서화한다.

@implSpec 주석은 해당 메서드와 하위 클래스 사이의 계약을 설명하며, 하위클래스들이 그 메서드를 상속하거나 super키워드를 이용해 호출할 때 그 메서드가 어떻게 동작하는지를 명확히 인지하고 사용하도록 해줘야한다.

**@literal**

API설명에 <, >, & 등의 HTML메타문자를 포함시키려면 특별한 처리를 해야한다.

{@literal} 태그로 감싸면 HTML마크업이나 자바독 태그를 무시하게 해준다.

{@code}와 비슷하지만 코드 폰트로 렌더링하지는 않는다.

**문서화 주석의 첫 문장**

각 문서화 주석의 첫 번째 문장은 해당 요소의 요약설명으로 간주된다.

요약설명은 반드시 대상의 기능을 고유하게 기술해야한다.

즉, **한 클래스(혹은 인터페이스)안에서 요약 설명이 똑같은 멤버(혹은 생성자)가 둘 이상이면 안된다.**

요약설명에서는 마침표(.)를 주의해야한다. 마침표의 위치까지면 요약설명이 되기 때문이다.

요약설명의 끝을 의도하지 않은것이라면 텍스트를 {@liteeral}로 감싸면 된다.

메서드와 생성자의 요약설명은 해당 메서드와 생성자의 동작을 설명하는 (주어가 없는) 동사구여야 한다.

- ex)  ArrayList(int initialCapacity) 요약설명

```java
지정한 초기 용량을 갖는 빈 리스트를 생성한다.
```

**검색(색인)**

자바 9부터는 자바독이 생성한 HTML문서에 검색 기능이 추가되었다.

클래스, 메서드, 필드같은 API요소의 색인은 자동으로 만들어지며 원할경우 {@index} 태그를 사용하여 API에서 중요한 용어를 추가로 색인화할 수 있따.

ex)

```java
/**
* This method compiles with the {@index IEEE 754} standard.
*/
```

**제네릭, 열거타입, 애너테이션 문서화 주석**

제네릭 타입이나 제니릭 메서드를 문서화할때는 모든 타입 매개변수에 주석을 달아야 한다.

ex)

```java
/**
* ...
* 
* @param <K> the type of keys maintained by this map
* @param <V> the type of mapped values
* /
public interface Map<K, V> {...}
```

열거타입을 문서화할때는 상수들에도 주석을 달아야 한다.

ex)

```java
/**
* ...
*/
public enum OchestraSection {
	/** Woodwinds, such as flute, clarinet, and oboe. */
	WOODWIND,
	
	/** Brass instruments, such as french horn and trumpet. */
	BRASS,
  ...
```

애너테이션 타입을 문서화할 때는 멤버들에도 모두 주석을 달아야 한다.

필드 설명은 명사구로, 요약설명은 이 애너테이션을 다는것이 어떤 의미인지를 설명하는 동사구로 작성한다.

ex)

```java
/**
* ~~~
*/
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface ExceptuionTest{
	/**
	* the exception that the annotated test method must throw in order to pass.
	*/
	Class<? exdtends Throwable> value();
}
```

API문서화에서 자주 누락되는 설명으로 스레드 안정성과 직렬화 가능성이 있따.

**클래스 혹은 정적 메서드가 스레드 안전하든 그렇지 않든, 스레드 안전 수준을 반드시 API설명에 포함해야 한다.**

**직렬화할 수 있는 클래스라면 직렬화 형태도 API설명에 기술해야 한다**

**문서화 주석 상속**

자바독은 메서드 주석을 상속시킬 수 있따.

문서화 주석이 없는 API요소를 발견하면 자바독이 가장 가까운 문서화 주석을 찾아준다.

이 때 상위 클래스보다 그 클래스가 구현한 인터페이스를 먼저 찾는다.

또한 {@inheritDoc}태그를 사용해서 상위 타입의 문서화 주석 일부를 상속할 수 있따.

클래스는 자신이 구현한 인터페이스의 문서화 주석을 복붙 없이 재사용할 수 있다는 뜻이다.

**자바독 문서 검증**

자바독은 자바독 문서를 올바르게 작성했는지 확인하는 기능을 제공한다.

자바 7에선 -Xdoclint 옵션을 주면 이 기능이 활성화되고

자바 8부터는 기본으로 적용된다.

이외에도 체크스타일같은 IDE플러그인이나 HTML유효성검사기를 사용하여 주석오류를 검사할 수 있따.